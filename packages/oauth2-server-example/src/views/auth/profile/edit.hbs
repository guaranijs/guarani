{{#extend "_layout"}}

{{#content "custom-css"}}
<link rel="stylesheet" type="text/css" href="/static/css/auth/profile.css" />
{{/content}}

{{#content "body"}}
<section class="container py-5">
  <div class="row">
    {{!-- User Info Overview --}}
    <div class="col-lg-4">
      <div class="card shadow-sm" id="user-info-overview">
        <div class="card-body text-center">
          {{#if user.picture}}
          <img src="{{ user.picture }}" class="rounded-circle img-fluid" id="user-picture" alt="Avatar" />
          {{else}}
          <img src="/static/img/user.svg" class="rounded-circle img-fluid" id="user-picture" alt="Avatar" />
          {{/if}}

          <div class="row">
            <div class="col-12 d-flex justify-content-center align-items-center">
              <h5 class="my-3">{{#if user.nickname}} {{ user.nickname }} {{^}} {{ user.name }} {{/if}}</h5>
              {{#if user.deletedAt}}
              <i class="bi bi-x-circle-fill mx-2" style="color: red"></i>
              {{else}}
              <i class="bi bi-patch-check-fill mx-2" style="color: green"></i>
              {{/if}}
            </div>
          </div>

          <div class="row">
            <div class="col-12 d-flex justify-content-center align-items-center">
              <i class="bi bi-envelope-fill"></i>
              <a href="mailto:{{ user.email }}" target="_blank" class="btn btn-white text-muted text-decoration-none">
                {{ user.email }}
              </a>
            </div>
          </div>

          <div class="row">
            <div class="col-12 d-flex justify-content-center align-items-center">
              {{#if user.website}}
              <a href="{{ user.website }}" target="_blank" class="btn btn-white"><i class="bi bi-globe"></i></a>
              {{/if}}
              {{#if user.facebook}}
              <a href="{{ user.facebook }}" target="_blank" class="btn btn-white"><i class="bi bi-facebook"></i></a>
              {{/if}}
              {{#if user.twitter}}
              <a href="{{ user.twitter }}" target="_blank" class="btn btn-white"><i class="bi bi-twitter"></i></a>
              {{/if}}
              {{#if user.instagram}}
              <a href="{{ user.instagram }}" target="_blank" class="btn btn-white"><i class="bi bi-instagram"></i></a>
              {{/if}}
              {{#if user.github}}
              <a href="{{ user.github }}" target="_blank" class="btn btn-white"><i class="bi bi-github"></i></a>
              {{/if}}
              {{#if user.linkedin}}
              <a href="{{ user.linkedin }}" target="_blank" class="btn btn-white"><i class="bi bi-linkedin"></i></a>
              {{/if}}
            </div>
          </div>
        </div>
      </div>
    </div>

    {{!-- User Personal Info --}}
    <div class="col-lg-8">
      {{#if error}}
      <div class="alert alert-danger">{{ error }}</div>
      {{/if}}

      <form method="post" action="/auth/profile/edit">
        <input type="hidden" name="_csrf" value="{{ csrf }}" />

        <div class="card shadow-sm" id="user-personal-info">
          <div class="card-body">
            <div class="row">
              <div class="col-12">
                <h3>Personal Info</h3>
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3"><strong>Given Name</strong></div>
              <div class="col-sm-9">
                <input type="text" name="given_name" value="{{ user.givenName }}" class="form-control" required />
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3"><strong>Middle Name</strong></div>
              <div class="col-sm-9">
                <input type="text" name="middle_name" value="{{ user.middleName }}" class="form-control" />
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3"><strong>Family Name</strong></div>
              <div class="col-sm-9">
                <input type="text" name="family_name" value="{{ user.familyName }}" class="form-control" required />
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3"><strong>Nickname</strong></div>
              <div class="col-sm-9">
                <input type="text" name="nickname" value="{{ user.nickname }}" class="form-control" />
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3"><strong>Preferred Username</strong></div>
              <div class="col-sm-9">
                <input type="text" name="preferred_username" value="{{ user.preferredUsername }}" class="form-control" />
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3"><strong>Birthdate</strong></div>
              <div class="col-sm-9">
                <input type="date" name="birthdate" value="{{ isodate user.birthdate }}" class="form-control" required />
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3"><strong>Gender</strong></div>
              <div class="col-sm-9">
                <select name="gender" class="form-select">
                  <option selected></option>
                  <option value="M">Male</option>
                  <option value="F">Female</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <div class="card shadow-sm mt-4" id="user-contacts">
          <div class="card-body">
            <div class="row">
              <div class="col-12">
                <h3>Contacts</h3>
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3"><strong>Email</strong></div>
              <div class="col-sm-9">
                <div class="row">
                  <div class="col-12 d-flex align-items-center">
                    <input type="email" name="email" value="{{ user.email }}" class="form-control" required />
                  </div>
                </div>
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3"><strong>Phone Number</strong></div>
              <div class="col-sm-9">
                <div class="row">
                  <div class="col-12 d-flex align-items-center">
                    <input type="tel" name="phone_number" value="{{ user.phoneNumber }}" class="form-control" />
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        {{#with user.address}}
        <div class="card shadow-sm mt-4">
          <div class="card-body">
            <div class="row">
              <div class="col-12">
                <h3>Address</h3>
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3"><strong>Street Address</strong></div>
              <div class="col-sm-9">
                <input type="text" name="street_address" value="{{ streetAddress }}" class="form-control" />
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3"><strong>Locality</strong></div>
              <div class="col-sm-9">
                <input type="text" name="locality" value="{{ locality }}" class="form-control" />
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3"><strong>Region</strong></div>
              <div class="col-sm-9">
                <input type="text" name="region" value="{{ region }}" class="form-control" />
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3"><strong>Postal Code</strong></div>
              <div class="col-sm-9">
                <input type="text" name="postal_code" value="{{ postalCode }}" class="form-control" />
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3"><strong>Country</strong></div>
              <div class="col-sm-9">
                <input type="text" name="country" value="{{ country }}" class="form-control" />
              </div>
            </div>
          </div>
        </div>
        {{/with}}

        <div class="mt-4">
          <button type="submit" class="btn btn-primary">Save</button>
          <button type="button" class="btn btn-outline-dark" onclick="closeEditProfileForm()">Close</button>
        </div>
      </form>
    </div>
  </div>
</section>
{{/content}}

{{#content "custom-js"}}
<script type="text/javascript" src="/static/js/auth/profile/edit.js"></script>
{{/content}}
{{/extend}}
